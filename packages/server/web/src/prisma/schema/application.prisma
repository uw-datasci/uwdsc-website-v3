model Application {
  id                 BigInt            @id @default(autoincrement())
  profile_id         String            @db.Uuid
  term_id            BigInt
  roles_applying_for Role[]            @default([]) // max 3, prisma cannot enforce
  resume_path        String?           @db.VarChar(500)
  status             ApplicationStatus @default(draft)
  comments           String?           @db.Text
  created_at         DateTime          @default(now()) @db.Timestamptz(6)
  updated_at         DateTime          @default(now()) @updatedAt @db.Timestamptz(6)
  submitted_at       DateTime?         @db.Timestamptz(6)

  // Relations
  profile Profile             @relation(fields: [profile_id], references: [id], onDelete: Cascade)
  term    Term                @relation(fields: [term_id], references: [id], onDelete: Cascade)
  answers ApplicationAnswer[]

  @@unique([profile_id, term_id])
  @@map("application")
}

model ApplicationAnswer {
  id             BigInt   @id @default(autoincrement())
  application_id BigInt
  question_id    BigInt
  answer_text    String?  @db.Text
  answer_option  String?  @db.Text
  answer_options String[]
  answer_file    String?  @db.VarChar(500)
  created_at     DateTime @default(now()) @db.Timestamptz(6)
  updated_at     DateTime @default(now()) @updatedAt @db.Timestamptz(6)

  // Relations
  application Application @relation(fields: [application_id], references: [id], onDelete: Cascade)
  question    Question    @relation(fields: [question_id], references: [id], onDelete: Cascade)

  @@unique([application_id, question_id])
  @@map("application_answer")
}
