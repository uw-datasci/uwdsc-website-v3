model Applications {
  id                 BigInt                @id @default(autoincrement())
  profile_id         String                @db.Uuid
  term_id            BigInt
  roles_applying_for RoleEnum[]            @default([]) // max 3, prisma cannot enforce
  resume_path        String?               @db.VarChar(500)
  status             ApplicationStatusEnum @default(draft)
  comments           String?               @db.Text
  created_at         DateTime              @default(now()) @db.Timestamptz(6)
  updated_at         DateTime              @default(now()) @updatedAt @db.Timestamptz(6)
  submitted_at       DateTime?             @db.Timestamptz(6)

  // Relations
  profile Profiles             @relation(fields: [profile_id], references: [id], onDelete: Cascade)
  term    Terms                @relation(fields: [term_id], references: [id], onDelete: Cascade)
  answers ApplicationAnswers[]

  @@unique([profile_id, term_id])
  @@map("applications")
}

model ApplicationAnswers {
  id             BigInt   @id @default(autoincrement())
  application_id BigInt
  question_id    BigInt
  answer_text    String?  @db.Text
  answer_option  String?  @db.Text
  answer_options String[]
  answer_file    String?  @db.VarChar(500)
  created_at     DateTime @default(now()) @db.Timestamptz(6)
  updated_at     DateTime @default(now()) @updatedAt @db.Timestamptz(6)

  // Relations
  application Applications @relation(fields: [application_id], references: [id], onDelete: Cascade)
  question    Questions    @relation(fields: [question_id], references: [id], onDelete: Cascade)

  @@unique([application_id, question_id])
  @@map("application_answers")
}
